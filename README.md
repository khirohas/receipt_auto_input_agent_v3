# 領収書自動入力エージェント

GPT-4oを使用して領収書画像から情報を抽出し、Excelファイルに自動記入する動画デモ用アプリケーションです。

## 🎯 機能

- **OCR処理**: GPT-4oによる高精度な領収書画像認識
- **自動分類**: 品目を自動判定（飲食費、交通費、宿泊費など）
- **Excel出力**: 見やすい形式でExcelファイルを生成
- **ChatGPT風UI**: 直感的なチャットインターフェース

## 📋 処理対象情報

- 支払先（店名・会社名など）
- 日付（yyyy/mm/dd形式）
- 金額（¥付き通貨フォーマット）
- 品目（自動判定）
- 備考（特記がある場合のみ）

## 📁 品目リスト

飲食費／交通費／宿泊費／備品費／通信費／消耗品費／印刷製本費／会場費／雑費／交際費

## 🚀 セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. OpenAI APIキーの設定

環境変数または`.env`ファイルでOpenAI APIキーを設定してください：

```bash
export OPENAI_API_KEY="your-openai-api-key-here"
```

または、`.env`ファイルを作成：

```
OPENAI_API_KEY=your-openai-api-key-here
```

### 3. サーバーの起動

```bash
npm start
```

開発モード（自動再起動）：

```bash
npm run dev
```

### 4. ブラウザでアクセス

```
http://localhost:3000
```

## 📖 使用方法

1. **画像アップロード**: 領収書画像をドラッグ&ドロップまたはクリックして選択
2. **処理開始**: 「はい」ボタンをクリックしてOCR処理を開始
3. **ダウンロード**: 生成されたExcelファイルをダウンロード

## 🎬 動画デモ用サンプル

`sample-images/`ディレクトリにサンプル領収書画像を配置してください。

### 推奨サンプル画像
- 飲食店の領収書
- 交通費の領収書
- 宿泊費の領収書
- 備品購入の領収書

## 📊 Excel出力形式

| No. | 支払先 | 日付 | 金額 | 品目 | 備考 |
|-----|--------|------|------|------|------|
| 1 | サンプル店 | 2024/01/15 | ¥1,500 | 飲食費 | |
| 2 | 交通会社 | 2024/01/16 | ¥800 | 交通費 | |
| 合計 | | | ¥2,300 | | |

## 🔧 技術スタック

- **バックエンド**: Node.js, Express.js
- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **AI**: OpenAI GPT-4o
- **Excel処理**: ExcelJS
- **ファイル処理**: Multer

## 📁 プロジェクト構造

```
領収書自動入力エージェント/
├── server.js              # メインサーバーファイル
├── package.json           # 依存関係定義
├── README.md             # プロジェクト説明
├── public/               # フロントエンドファイル
│   ├── index.html        # メインHTML
│   ├── style.css         # スタイルシート
│   └── script.js         # フロントエンドJavaScript
├── uploads/              # アップロードされた画像（一時）
├── downloads/            # 生成されたExcelファイル
└── sample-images/        # サンプル画像
```

## ⚠️ 注意事項

- OpenAI APIキーが必要です
- 画像ファイルは一時的に`uploads/`ディレクトリに保存されます
- 生成されたExcelファイルは`downloads/`ディレクトリに保存されます
- 処理後は一時ファイルは自動的に削除されます

## 🎯 動画デモ用のポイント

1. **最小構成**: 必要最小限の機能に絞った設計
2. **視覚的効果**: モダンなUIとアニメーション
3. **分かりやすさ**: 直感的な操作フロー
4. **実用性**: 実際に使えるレベルの精度

## �� ライセンス

MIT License 